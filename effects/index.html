<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>p5.js FX Lab</title>
<script src="https://cdn.jsdelivr.net/npm/p5@1.9.3/lib/p5.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/lil-gui@0.21.0/dist/lil-gui.umd.min.js"></script>
</head>
<body>
<script>
let img, sh, gui
let params={
effect:"repeat tile",
amount:0.5,
amount2:0.5,
animate:true,
speed:1,
savePNG:()=>saveCanvas("export","png"),
saveJPG:()=>saveCanvas("export","jpg"),
saveJPEG:()=>saveCanvas("export","jpeg")
}
function preload(){
img=loadImage("https://archive.org/download/nices-1/nices-1.png")
}
function setup(){
createCanvas(1920,1080,WEBGL)
noStroke()
sh=createShader(vs,fs)
gui=new lil.GUI()
gui.add(params,"effect",[
"repeat tile","swirl","waves","pinch/bulge","rgb split","rainbow",
"kaleidoscope","pixelate","posterize","drunk","rounded rect",
"blur gaussian","hexagonize","colorize","hue/saturation","hue cycle",
"vignette","crt curvature","crt scanlines"
])
gui.add(params,"amount",-10,10)
gui.add(params,"amount2",-10,10)
gui.add(params,"animate")
gui.add(params,"speed",0,5)
gui.add(params,"savePNG")
gui.add(params,"saveJPG")
gui.add(params,"saveJPEG")
}
function draw(){
shader(sh)
sh.setUniform("tex0",img)
sh.setUniform("res",[width,height])
sh.setUniform("time",millis()/1000)
sh.setUniform("effect",effectIndex(params.effect))
sh.setUniform("amount",params.amount)
sh.setUniform("amount2",params.amount2)
sh.setUniform("animate",params.animate?1:0)
sh.setUniform("speed",params.speed)
rect(-width/2,-height/2,width,height)
}
function effectIndex(n){
return [
"repeat tile","swirl","waves","pinch/bulge","rgb split","rainbow",
"kaleidoscope","pixelate","posterize","drunk","rounded rect",
"blur gaussian","hexagonize","colorize","hue/saturation","hue cycle",
"vignette","crt curvature","crt scanlines"
].indexOf(n)
}
const vs=`
precision highp float;
attribute vec3 aPosition;
attribute vec2 aTexCoord;
varying vec2 vUv;
void main(){
vUv=aTexCoord;
gl_Position=vec4(aPosition,1.0);
}`
const fs=`
precision highp float;
uniform sampler2D tex0;
uniform vec2 res;
uniform float time;
uniform int effect;
uniform float amount;
uniform float amount2;
uniform float animate;
uniform float speed;
varying vec2 vUv;
vec3 hsv2rgb(vec3 c){
vec4 K=vec4(1.,2./3.,1./3.,3.);
vec3 p=abs(fract(c.xxx+K.xyz)*6.-K.www);
return c.z*mix(K.xxx,clamp(p-K.xxx,0.,1.),c.y);
}
vec3 rgb2hsv(vec3 c){
vec4 K=vec4(0.,-1./3.,2./3.,-1.);
vec4 p=mix(vec4(c.bg,K.wz),vec4(c.gb,K.xy),step(c.b,c.g));
vec4 q=mix(vec4(p.xyw,c.r),vec4(c.r,p.yzx),step(p.x,c.r));
float d=q.x-min(q.w,q.y);
float e=1e-10;
return vec3(abs(q.z+(q.w-q.y)/(6.*d+e)),d/(q.x+e),q.x);
}
void main(){
vec2 uv=vUv;
float t=time*speed*animate;
if(effect==0){
uv=fract(uv*(1.+amount*5.));
}
if(effect==1){
vec2 p=uv-0.5;
float r=length(p);
float a=atan(p.y,p.x)+amount*5.*r+ t;
uv=vec2(cos(a),sin(a))*r+0.5;
}
if(effect==2){
uv.y+=sin((uv.x+ t)*20.)*amount*0.1;
uv.x+=cos((uv.y+ t)*20.)*amount*0.1;
}
if(effect==3){
vec2 p=uv-0.5;
float r=length(p);
uv=0.5+p*(1.+amount*(0.5-r)*2.);
}
vec3 col=texture2D(tex0,uv).rgb;
if(effect==4){
float off=amount*0.01;
col.r=texture2D(tex0,uv+vec2(off,0)).r;
col.g=texture2D(tex0,uv).g;
col.b=texture2D(tex0,uv-vec2(off,0)).b;
}
if(effect==5){
col=hsv2rgb(vec3(uv.x+ t*0.1,1.,1.));
}
if(effect==6){
vec2 p=uv-0.5;
float a=atan(p.y,p.x);
float r=length(p);
float k=6.+amount*12.;
a=mod(a,6.28318/k)*k;
uv=vec2(cos(a),sin(a))*r+0.5;
col=texture2D(tex0,uv).rgb;
}
if(effect==7){
float px=1./mix(20.,400.,amount);
uv=floor(uv/px)*px;
col=texture2D(tex0,uv).rgb;
}
if(effect==8){
col=floor(col*mix(2.,16.,amount))/mix(2.,16.,amount);
}
if(effect==9){
uv+=vec2(sin(t*3.),cos(t*2.))*amount*0.02;
col=texture2D(tex0,uv).rgb;
}
if(effect==10){
float r=min(min(uv.x,uv.y),min(1.-uv.x,1.-uv.y));
col*=smoothstep(0.,amount*0.2,r);
}
if(effect==11){
vec2 o=vec2(amount*0.002);
col=(
texture2D(tex0,uv+o).rgb+
texture2D(tex0,uv-o).rgb+
texture2D(tex0,uv+vec2(o.x,-o.y)).rgb+
texture2D(tex0,uv+vec2(-o.x,o.y)).rgb
)*0.25;
}
if(effect==12){
float q=amount*20.;
uv=floor(uv*q)/q;
col=texture2D(tex0,uv).rgb;
}
if(effect==13){
col*=vec3(1.,amount,amount2);
}
if(effect==14){
vec3 h=rgb2hsv(col);
h.y=amount;
col=hsv2rgb(h);
}
if(effect==15){
vec3 h=rgb2hsv(col);
h.x+=t*0.1;
col=hsv2rgb(h);
}
if(effect==16){
float d=distance(uv,vec2(0.5));
col*=smoothstep(0.8,amount*0.8,d);
}
if(effect==17){
vec2 p=uv-0.5;
p*=1.+dot(p,p)*amount;
uv=p+0.5;
col=texture2D(tex0,uv).rgb;
}
if(effect==18){
col*=step(0.5,fract(uv.y*res.y*0.5));
}
gl_FragColor=vec4(col,1.);
}`
</script>
</body>
</html>
